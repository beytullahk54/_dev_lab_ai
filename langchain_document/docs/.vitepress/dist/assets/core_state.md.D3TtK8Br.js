import{_ as a,o as i,c as n,ag as t}from"./chunks/framework.DEqXEGcv.js";const E=JSON.parse('{"title":"State (Durum) Yönetimi","description":"","frontmatter":{},"headers":[],"relativePath":"core/state.md","filePath":"core/state.md"}'),e={name:"core/state.md"};function l(p,s,h,k,r,d){return i(),n("div",null,[...s[0]||(s[0]=[t(`<h1 id="state-durum-yonetimi" tabindex="-1">State (Durum) Yönetimi <a class="header-anchor" href="#state-durum-yonetimi" aria-label="Permalink to &quot;State (Durum) Yönetimi&quot;">​</a></h1><p><strong>State</strong>, LangGraph grafındaki tüm düğümlerin okuyup yazabildiği ortak veri yapısıdır. Her düğüm çalıştığında state&#39;i alır, günceller ve bir sonraki düğüme geçer.</p><h2 id="typeddict-ile-state-tanımlama" tabindex="-1">TypedDict ile State Tanımlama <a class="header-anchor" href="#typeddict-ile-state-tanımlama" aria-label="Permalink to &quot;TypedDict ile State Tanımlama&quot;">​</a></h2><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># core/state.py</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> typing </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> TypedDict</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> AgentState</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TypedDict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    user_query: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      # Kullanıcının sorusu</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    intent: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">          # Belirlenen niyet (math, legal, greeting...)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    final_answer: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # Son yanıt</span></span></code></pre></div><p>Bu 3 alan projenizin tüm akışını taşıyan temel yapıdır.</p><h2 id="state-nasıl-calısır" tabindex="-1">State Nasıl Çalışır? <a class="header-anchor" href="#state-nasıl-calısır" aria-label="Permalink to &quot;State Nasıl Çalışır?&quot;">​</a></h2><p>Her düğüm şu imzaya sahiptir:</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> my_node</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(state: AgentState) -&gt; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">dict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # state&#39;i oku</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    query </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> state[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;user_query&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # işlem yap...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    result </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> do_something(query)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # sadece değiştirdiğin alanları döndür</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;final_answer&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: result}</span></span></code></pre></div><p>LangGraph dönen dict&#39;i mevcut state ile <strong>birleştirir (merge)</strong>. Tüm state&#39;i döndürmen gerekmez.</p><h2 id="projenizde-state-akısı" tabindex="-1">Projenizde State Akışı <a class="header-anchor" href="#projenizde-state-akısı" aria-label="Permalink to &quot;Projenizde State Akışı&quot;">​</a></h2><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Başlangıç State:</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>  &quot;user_query&quot;: &quot;İki sayının toplamı nasıl hesaplanır?&quot;,</span></span>
<span class="line"><span>  &quot;intent&quot;: &quot;&quot;,</span></span>
<span class="line"><span>  &quot;final_answer&quot;: &quot;&quot;</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>         ↓  main_router_agent çalışır</span></span>
<span class="line"><span></span></span>
<span class="line"><span>State (main_agent sonrası):</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>  &quot;user_query&quot;: &quot;İki sayının toplamı nasıl hesaplanır?&quot;,</span></span>
<span class="line"><span>  &quot;intent&quot;: &quot;math&quot;,          ← güncellendi</span></span>
<span class="line"><span>  &quot;final_answer&quot;: &quot;&quot;</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>         ↓  math_expert_node çalışır</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Final State:</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>  &quot;user_query&quot;: &quot;İki sayının toplamı nasıl hesaplanır?&quot;,</span></span>
<span class="line"><span>  &quot;intent&quot;: &quot;math&quot;,</span></span>
<span class="line"><span>  &quot;final_answer&quot;: &quot;İki sayıyı + operatörü ile toplayabilirsin...&quot;  ← güncellendi</span></span>
<span class="line"><span>}</span></span></code></pre></div><h2 id="state-e-yeni-alan-eklemek" tabindex="-1">State&#39;e Yeni Alan Eklemek <a class="header-anchor" href="#state-e-yeni-alan-eklemek" aria-label="Permalink to &quot;State&#39;e Yeni Alan Eklemek&quot;">​</a></h2><p>Sistemi genişletirken state&#39;e alan ekleyebilirsin:</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> typing </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> TypedDict, List</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> AgentState</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TypedDict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    user_query: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    intent: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    final_answer: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # Yeni alanlar:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    retrieved_docs: List[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]    </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># RAG&#39;dan gelen belgeler</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    confidence: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">float</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">            # Güven skoru</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    language: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                # Tespit edilen dil</span></span></code></pre></div><div class="warning custom-block"><p class="custom-block-title">Dikkat</p><p>State alanlarını <code>TypedDict</code> ile tanımlarken varsayılan değer veremezsin. Başlangıç state&#39;i <code>app.invoke()</code> çağrısında belirtmelisin:</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">app.invoke({</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;user_query&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;soru&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;intent&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;final_answer&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div></div><h2 id="annotated-ile-gelismis-state" tabindex="-1">Annotated ile Gelişmiş State <a class="header-anchor" href="#annotated-ile-gelismis-state" aria-label="Permalink to &quot;Annotated ile Gelişmiş State&quot;">​</a></h2><p>Birden fazla düğümün aynı alana veri eklemesini istiyorsan <code>Annotated</code> kullan:</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> typing </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Annotated</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> langgraph.graph.message </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> add_messages</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ChatState</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TypedDict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    messages: Annotated[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">list</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, add_messages]  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Her düğüm mesaj ekler, silmez</span></span></code></pre></div><p>Bu pattern sohbet geçmişi tutmak için idealdir.</p><h2 id="sonraki-adım" tabindex="-1">Sonraki Adım <a class="header-anchor" href="#sonraki-adım" aria-label="Permalink to &quot;Sonraki Adım&quot;">​</a></h2><p><a href="/core/llm.html">LLM Bağlantısı →</a></p>`,21)])])}const c=a(e,[["render",l]]);export{E as __pageData,c as default};
